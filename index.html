<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Gerador Final â€“ Representantes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- SheetJS para ler Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <!-- Chart.js para grÃ¡ficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <!-- Plugin para mostrar valores dentro das colunas -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>

  <style>
    :root {
      --bg: #f3f4f6;
      --bg-soft: #e5e7eb;
      --card: #ffffff;
      --card-border: #d1d5db;
      --primary: #facc15;   /* amarelo Power BI */
      --primary-dark: #eab308;
      --primary-soft: rgba(250, 204, 21, 0.12);
      --text-main: #111827;
      --text-muted: #6b7280;
      --danger: #dc2626;
      --success: #16a34a;
      --chart-meta: #3b82f6;
      --chart-meta-border: #1d4ed8;
      --chart-ating: #22c55e;
      --chart-ating-border: #15803d;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top left, #e5e7eb 0, #f9fafb 40%, #e5e7eb 100%);
      color: var(--text-main);
      min-height: 100vh;
    }

    header {
      padding: 14px 22px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      background: linear-gradient(90deg, #111827, #1f2937 45%, #facc15 120%);
      color: #f9fafb;
      box-shadow: 0 10px 25px rgba(0,0,0,0.22);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    header .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    header h1 {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    header h1::before {
      content: "";
      width: 9px;
      height: 22px;
      border-radius: 999px;
      background: linear-gradient(to bottom, #facc15, #f97316);
    }

    header span.subtitle {
      font-size: 13px;
      color: #e5e7eb;
      opacity: 0.9;
    }

    .upload-area {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    input[type="file"] {
      display: none;
    }

    .file-label {
      cursor: pointer;
      border-radius: 999px;
      border: 1px solid rgba(249,250,251,0.4);
      padding: 7px 13px;
      font-size: 12px;
      color: #f9fafb;
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(15,23,42,0.2);
      backdrop-filter: blur(6px);
      transition: 0.16s ease;
    }

    .file-label:hover {
      background: rgba(249,250,251,0.08);
      border-color: rgba(250,204,21,0.8);
    }

    .file-name {
      max-width: 220px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-weight: 500;
    }

    main {
      padding: 20px 22px 30px;
      max-width: 1440px;
      margin: 0 auto;
    }

    .section-title-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
    }

    .section-title-row h2 {
      font-size: 16px;
      font-weight: 600;
      color: #111827;
    }

    .section-title-row span {
      font-size: 12px;
      color: var(--text-muted);
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      border: 1px solid var(--card-border);
      padding: 16px 16px 14px;
      box-shadow:
        0 12px 30px rgba(15,23,42,0.06),
        0 1px 0 rgba(148,163,184,0.4);
      position: relative;
      overflow: hidden;
      margin-bottom: 16px;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at top left, rgba(250,204,21,0.14), transparent 55%);
      opacity: 0.7;
      pointer-events: none;
      z-index: -1;
    }

    .card h2 {
      font-size: 15px;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #111827;
    }

    .badge {
      font-size: 11px;
      padding: 2px 9px;
      border-radius: 999px;
      border: 1px solid rgba(250,204,21,0.7);
      color: #854d0e;
      background: rgba(250,204,21,0.18);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .caption {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .resumo-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 8px;
    }

    .mini-card {
      padding: 10px 12px 9px;
      border-radius: 14px;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .mini-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .mini-value {
      font-size: 17px;
      font-weight: 700;
      color: #111827;
    }

    .mini-extra {
      font-size: 11px;
      color: var(--text-muted);
    }

    .mini-extra.ok {
      color: var(--success);
      font-weight: 600;
    }

    .mini-extra.bad {
      color: var(--danger);
      font-weight: 600;
    }

    .filters-card .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-top: 8px;
    }

    .filters-card label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .filters-card select {
      background: #f9fafb;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      padding: 6px 10px;
      font-size: 12px;
      color: var(--text-main);
      min-width: 180px;
      outline: none;
      transition: 0.14s ease;
    }

    .filters-card select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 1px rgba(250,204,21,0.7);
    }

    .charts-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.2fr);
      gap: 16px;
      margin-bottom: 16px;
    }

    .chart-wrapper {
      margin-top: 10px;
      height: 280px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      border-spacing: 0;
      font-size: 12px;
      margin-top: 10px;
    }

    thead {
      background: var(--primary-soft);
    }

    th, td {
      padding: 6px 8px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
      white-space: nowrap;
    }

    th {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    tbody tr:nth-child(even) {
      background: #f9fafb;
    }

    tbody tr:hover {
      background: #fefce8;
    }

    .align-right {
      text-align: right;
    }

    .status-ok {
      color: var(--success);
      font-weight: 600;
    }

    .status-bad {
      color: var(--danger);
      font-weight: 600;
    }

    .empty {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 10px;
    }

    @media (max-width: 1120px) {
      .charts-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 950px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    @media (max-width: 720px) {
      main {
        padding-inline: 12px;
      }
      .resumo-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 520px) {
      .resumo-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="title-block">
      <h1>Gerador Final â€“ Representantes</h1>
      <span class="subtitle">Semana 1 a 5 Â· Metas x Atingido por Estado e Representante</span>
    </div>

    <div class="upload-area">
      <label class="file-label">
        <span>ðŸ“„ Selecionar planilha (.xlsx)</span>
        <span class="file-name" id="fileName">Nenhum arquivo</span>
        <input type="file" id="fileInput" accept=".xlsx,.xls" />
      </label>
    </div>
  </header>

  <main>
    <!-- RESUMO GERAL -->
    <section class="card">
      <div class="section-title-row">
        <h2>VisÃ£o geral do mÃªs</h2>
        <span id="badgeMes" class="badge">MÃªs atual</span>
      </div>
      <p class="caption">Resumo geral calculado automaticamente a partir da planilha (Meta Mensal x Atingido).</p>

      <div class="resumo-grid">
        <div class="mini-card">
          <span class="mini-label">Representantes ativos</span>
          <span class="mini-value" id="totalReps">â€“</span>
          <span class="mini-extra">Linhas vÃ¡lidas com representante preenchido</span>
        </div>
        <div class="mini-card">
          <span class="mini-label">Meta total mensal (Q)</span>
          <span class="mini-value" id="metaTotal">R$ 0,00</span>
          <span class="mini-extra">SomatÃ³rio das metas do mÃªs</span>
        </div>
        <div class="mini-card">
          <span class="mini-label">Atingido total (R)</span>
          <span class="mini-value" id="vendasTotais">R$ 0,00</span>
          <span class="mini-extra" id="percGeral">Meta geral: â€“</span>
        </div>
      </div>
    </section>

    <!-- FILTROS (independentes) -->
    <section class="card filters-card">
      <h2>Filtros do painel</h2>
      <p class="caption">Cada grÃ¡fico usa seu prÃ³prio filtro, independentes um do outro.</p>

      <div class="filters-row">
        <label for="estadoFiltroEstado">Estado â€“ grÃ¡fico ESTADO:</label>
        <select id="estadoFiltroEstado">
          <option value="__ALL__">Todos</option>
        </select>
      </div>

      <div class="filters-row">
        <label for="repFiltroRep">Representante â€“ grÃ¡fico REPRESENTANTE:</label>
        <select id="repFiltroRep">
          <option value="__ALL__">Todos</option>
        </select>
      </div>
    </section>

    <!-- GRÃFICOS: ESTADO E REPRESENTANTE -->
    <div class="charts-grid">
      <section class="card">
        <div class="section-title-row">
          <h2>Meta x Atingido por Semana â€“ Estado</h2>
          <span>Semana 1 a 5 Â· agregado por UF</span>
        </div>
        <div class="chart-wrapper">
          <canvas id="chartEstadoSemanas"></canvas>
        </div>
      </section>

      <section class="card">
        <div class="section-title-row">
          <h2>Meta x Atingido por Semana â€“ Representante</h2>
          <span>Semana 1 a 5 Â· representante selecionado</span>
        </div>
        <div class="chart-wrapper">
          <canvas id="chartRepSemanas"></canvas>
        </div>
      </section>
    </div>

    <!-- TABELA DETALHADA -->
    <section class="card">
      <div class="section-title-row">
        <h2>Detalhamento por Estado, Representante e Semana</h2>
        <span>Dados brutos lidos das colunas Aâ€“O / Qâ€“S</span>
      </div>
      <p class="caption">
        Estado, Representante, Meta e Atingido em cada semana (Fâ€“O) e totais do mÃªs (Q/R/S).
      </p>

      <div id="tabelaContainer">
        <p class="empty" id="msgVazio">
          Importe a planilha para visualizar a tabela.
        </p>

        <table id="tabelaDados" style="display:none;">
          <thead>
            <tr>
              <th>Estado (A)</th>
              <th>Representante (B)</th>
              <th class="align-right">Meta MÃªs (Q)</th>
              <th class="align-right">Atingido MÃªs (R)</th>
              <th class="align-right">% MÃªs (S)</th>
              <th class="align-right">Sem 1 Meta (F)</th>
              <th class="align-right">Sem 1 Ating. (G)</th>
              <th class="align-right">Sem 2 Meta (H)</th>
              <th class="align-right">Sem 2 Ating. (I)</th>
              <th class="align-right">Sem 3 Meta (J)</th>
              <th class="align-right">Sem 3 Ating. (K)</th>
              <th class="align-right">Sem 4 Meta (L)</th>
              <th class="align-right">Sem 4 Ating. (M)</th>
              <th class="align-right">Sem 5 Meta (N)</th>
              <th class="align-right">Sem 5 Ating. (O)</th>
            </tr>
          </thead>
          <tbody id="tbodyDados"></tbody>
        </table>
      </div>
    </section>
  </main>

  <script>
    // registra plugin de datalabels no Chart.js
    Chart.register(ChartDataLabels);

    const fileInput = document.getElementById('fileInput');
    const fileNameSpan = document.getElementById('fileName');

    let registros = [];
    let chartEstadoSemanas = null;
    let chartRepSemanas = null;

    fileInput.addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;
      fileNameSpan.textContent = file.name;

      const reader = new FileReader();
      reader.onload = function (evt) {
        const data = new Uint8Array(evt.target.result);
        const workbook = XLSX.read(data, { type: 'array' });

        const firstSheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[firstSheetName];

        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        processarPlanilha(rows);
      };
      reader.readAsArrayBuffer(file);
    });

    function safeStr(v) {
      if (v === null || v === undefined) return "";
      return String(v).trim();
    }

    function toNumber(v) {
      if (v === null || v === undefined || v === "") return 0;
      if (typeof v === "number") return v;
      const limpo = String(v).replace(/\./g, "").replace(",", ".");
      const num = parseFloat(limpo);
      return isNaN(num) ? 0 : num;
    }

    function formatCurrency(v) {
      return v.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
    }

    function formatPercent(v) {
      if (!isFinite(v)) return "â€“";
      return (v * 100).toLocaleString("pt-BR", { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + " %";
    }

    function processarPlanilha(rows) {
      registros = [];
      let totalMeta = 0;
      let totalAtingido = 0;

      // acha cabeÃ§alho (ESTADO / REPRESENTANTE)
      let headerIndex = -1;
      for (let i = 0; i < rows.length; i++) {
        const row = rows[i] || [];
        const c0 = safeStr(row[0]).toUpperCase();
        const c1 = safeStr(row[1]).toUpperCase();
        if (c0 === "ESTADO" && c1 === "REPRESENTANTE") {
          headerIndex = i;
          break;
        }
      }
      if (headerIndex === -1) {
        alert("NÃ£o encontrei o cabeÃ§alho (ESTADO / REPRESENTANTE) na planilha.");
        return;
      }

      const dataStart = headerIndex + 1;

      for (let i = dataStart; i < rows.length; i++) {
        const row = rows[i] || [];

        const estado = safeStr(row[0]);  // A
        const repNome = safeStr(row[1]); // B
        if (!repNome) continue;
        if (repNome.toUpperCase().startsWith("TOTAL")) continue;

        const metaMensal = toNumber(row[16]);  // Q
        const atingMensal = toNumber(row[17]); // R

        let percMes;
        if (row[18] !== undefined && row[18] !== null && row[18] !== "") {
          percMes = toNumber(row[18]);
          if (percMes > 1.5) percMes = percMes / 100;
        } else {
          percMes = metaMensal > 0 ? (atingMensal / metaMensal) : 0;
        }

        const sem1Meta = toNumber(row[5]);   // F
        const sem1Ating = toNumber(row[6]);  // G
        const sem2Meta = toNumber(row[7]);   // H
        const sem2Ating = toNumber(row[8]);  // I
        const sem3Meta = toNumber(row[9]);   // J
        const sem3Ating = toNumber(row[10]); // K
        const sem4Meta = toNumber(row[11]);  // L
        const sem4Ating = toNumber(row[12]); // M
        const sem5Meta = toNumber(row[13]);  // N
        const sem5Ating = toNumber(row[14]); // O

        const semanasMeta = [sem1Meta, sem2Meta, sem3Meta, sem4Meta, sem5Meta];
        const semanasAting = [sem1Ating, sem2Ating, sem3Ating, sem4Ating, sem5Ating];

        registros.push({
          estado,
          representante: repNome,
          metaMensal,
          atingMensal,
          percMes,
          semanasMeta,
          semanasAting
        });

        totalMeta += metaMensal;
        totalAtingido += atingMensal;
      }

      atualizarResumo(totalMeta, totalAtingido);
      popularFiltroEstadosEstado();
      popularFiltroRepresentantesRep();
      montarTabela();
      atualizarGraficosEstado();
      atualizarGraficosRep();
    }

    function atualizarResumo(totalMeta, totalAtingido) {
      document.getElementById("totalReps").textContent = registros.length;
      document.getElementById("metaTotal").textContent = formatCurrency(totalMeta);
      document.getElementById("vendasTotais").textContent = formatCurrency(totalAtingido);

      let texto = "Meta geral: â€“";
      if (totalMeta > 0) {
        const perc = totalAtingido / totalMeta;
        texto = "Meta geral: " + formatPercent(perc);
        const elem = document.getElementById("percGeral");
        elem.className = "mini-extra " + (perc >= 1 ? "ok" : "bad");
      } else {
        const elem = document.getElementById("percGeral");
        elem.className = "mini-extra";
      }
      document.getElementById("percGeral").textContent = texto;
    }

    // filtros independentes
    function popularFiltroEstadosEstado() {
      const select = document.getElementById("estadoFiltroEstado");
      select.innerHTML = "";
      const optTodos = document.createElement("option");
      optTodos.value = "__ALL__";
      optTodos.textContent = "Todos";
      select.appendChild(optTodos);

      const estadosSet = new Set(registros.map(r => r.estado));
      Array.from(estadosSet).sort().forEach(uf => {
        const opt = document.createElement("option");
        opt.value = uf;
        opt.textContent = uf;
        select.appendChild(opt);
      });

      select.value = "__ALL__";
      select.onchange = atualizarGraficosEstado;
    }

    function popularFiltroRepresentantesRep() {
      const select = document.getElementById("repFiltroRep");
      select.innerHTML = "";
      const optTodos = document.createElement("option");
      optTodos.value = "__ALL__";
      optTodos.textContent = "Todos";
      select.appendChild(optTodos);

      const repsSet = new Set(registros.map(r => r.representante));
      Array.from(repsSet).sort().forEach(nome => {
        const opt = document.createElement("option");
        opt.value = nome;
        opt.textContent = nome;
        select.appendChild(opt);
      });

      select.value = "__ALL__";
      select.onchange = atualizarGraficosRep;
    }

    function montarTabela() {
      const tbody = document.getElementById("tbodyDados");
      const tabela = document.getElementById("tabelaDados");
      const msgVazio = document.getElementById("msgVazio");

      tbody.innerHTML = "";

      if (!registros.length) {
        tabela.style.display = "none";
        msgVazio.style.display = "block";
        return;
      }

      msgVazio.style.display = "none";
      tabela.style.display = "table";

      registros.forEach(r => {
        const tr = document.createElement("tr");

        const tdEstado = document.createElement("td");
        tdEstado.textContent = r.estado;

        const tdRep = document.createElement("td");
        tdRep.textContent = r.representante;

        const tdMetaMes = document.createElement("td");
        tdMetaMes.className = "align-right";
        tdMetaMes.textContent = formatCurrency(r.metaMensal);

        const tdAtingMes = document.createElement("td");
        tdAtingMes.className = "align-right";
        tdAtingMes.textContent = formatCurrency(r.atingMensal);

        const tdPercMes = document.createElement("td");
        tdPercMes.className = "align-right";
        tdPercMes.textContent = formatPercent(r.percMes);
        tdPercMes.classList.add(r.percMes >= 1 ? "status-ok" : "status-bad");

        const criarCellSemana = (valor) => {
          const td = document.createElement("td");
          td.className = "align-right";
          td.textContent = valor ? formatCurrency(valor) : "â€“";
          return td;
        };

        const [s1M, s2M, s3M, s4M, s5M] = r.semanasMeta;
        const [s1A, s2A, s3A, s4A, s5A] = r.semanasAting;

        tr.appendChild(tdEstado);
        tr.appendChild(tdRep);
        tr.appendChild(tdMetaMes);
        tr.appendChild(tdAtingMes);
        tr.appendChild(tdPercMes);
        tr.appendChild(criarCellSemana(s1M));
        tr.appendChild(criarCellSemana(s1A));
        tr.appendChild(criarCellSemana(s2M));
        tr.appendChild(criarCellSemana(s2A));
        tr.appendChild(criarCellSemana(s3M));
        tr.appendChild(criarCellSemana(s3A));
        tr.appendChild(criarCellSemana(s4M));
        tr.appendChild(criarCellSemana(s4A));
        tr.appendChild(criarCellSemana(s5M));
        tr.appendChild(criarCellSemana(s5A));

        tbody.appendChild(tr);
      });
    }

    function criarConfigBar(labels, metaData, atingData) {
      return {
        type: "bar",
        data: {
          labels: labels,
          datasets: [
            {
              label: "Meta",
              data: metaData,
              backgroundColor: "#3b82f6",
              borderColor: "#1d4ed8",
              borderWidth: 1
            },
            {
              label: "Atingido",
              data: atingData,
              backgroundColor: "#22c55e",
              borderColor: "#15803d",
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: true,
              labels: {
                usePointStyle: true,
                boxWidth: 8
              }
            },
            tooltip: {
              callbacks: {
                label: (ctx) => {
                  const v = ctx.parsed.y || 0;
                  return ctx.dataset.label + ": " + formatCurrency(v);
                }
              }
            },
            datalabels: {
              anchor: "end",
              align: "end",
              offset: -2,
              clamp: true,
              color: "#111827",
              formatter: (value) => {
                if (!value) return "";
                return value.toLocaleString("pt-BR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
              },
              font: {
                size: 10,
                weight: "600"
              }
            }
          },
          scales: {
            y: {
              ticks: {
                callback: value => formatCurrency(value)
              },
              grid: {
                color: "#e5e7eb"
              }
            },
            x: {
              grid: {
                display: false
              }
            }
          }
        }
      };
    }

    function atualizarGraficosEstado() {
      if (!registros.length) return;

      const ufSel = document.getElementById("estadoFiltroEstado").value;
      const labelsSemanas = ["Semana 1", "Semana 2", "Semana 3", "Semana 4", "Semana 5"];

      let metaSemanasEstado = [0, 0, 0, 0, 0];
      let atingSemanasEstado = [0, 0, 0, 0, 0];

      registros.forEach(r => {
        if (ufSel === "__ALL__" || r.estado === ufSel) {
          for (let i = 0; i < 5; i++) {
            metaSemanasEstado[i] += r.semanasMeta[i] || 0;
            atingSemanasEstado[i] += r.semanasAting[i] || 0;
          }
        }
      });

      const ctxEstado = document.getElementById("chartEstadoSemanas").getContext("2d");
      if (chartEstadoSemanas) chartEstadoSemanas.destroy();
      chartEstadoSemanas = new Chart(ctxEstado, criarConfigBar(labelsSemanas, metaSemanasEstado, atingSemanasEstado));
    }

    function atualizarGraficosRep() {
      if (!registros.length) return;

      const repSel = document.getElementById("repFiltroRep").value;
      const labelsSemanas = ["Semana 1", "Semana 2", "Semana 3", "Semana 4", "Semana 5"];

      let metaSemanasRep = [0, 0, 0, 0, 0];
      let atingSemanasRep = [0, 0, 0, 0, 0];

      registros.forEach(r => {
        if (repSel === "__ALL__" || r.representante === repSel) {
          for (let i = 0; i < 5; i++) {
            metaSemanasRep[i] += r.semanasMeta[i] || 0;
            atingSemanasRep[i] += r.semanasAting[i] || 0;
          }
        }
      });

      const ctxRep = document.getElementById("chartRepSemanas").getContext("2d");
      if (chartRepSemanas) chartRepSemanas.destroy();
      chartRepSemanas = new Chart(ctxRep, criarConfigBar(labelsSemanas, metaSemanasRep, atingSemanasRep));
    }
  </script>
</body>
</html>

