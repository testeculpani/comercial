<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Somat√≥rio por Vendedor</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
    body { font-family: Arial; padding: 20px; }
    h2 { margin-top: 30px; }
    table { border-collapse: collapse; width: 300px; margin-top: 10px; }
    table, th, td { border: 1px solid #aaa; }
    th, td { padding: 8px; text-align: left; }
</style>
</head>
<body>

<h1>Importar Planilha e Somar Valores por Vendedor</h1>

<input type="file" id="inputExcel" accept=".xlsx, .xls">
<h2>Resultado:</h2>
<div id="resultado"></div>

<script>
document.getElementById('inputExcel').addEventListener('change', function(e) {
    let file = e.target.files[0];
    let reader = new FileReader();

    reader.onload = function(event) {
        let data = new Uint8Array(event.target.result);
        let workbook = XLSX.read(data, {type: 'array'});

        let sheet = workbook.Sheets[workbook.SheetNames[0]];
        let json = XLSX.utils.sheet_to_json(sheet);

        // objeto para somar por vendedor
        let totais = {};

        json.forEach(linha => {
            let vendedor = linha["Q"] || linha["Vendedor"] || linha["VENDEDOR"];
            let valor = parseFloat(linha["F"]) || 0;

            if (vendedor) {
                if (!totais[vendedor]) totais[vendedor] = 0;
                totais[vendedor] += valor;
            }
        });

        // monta tabela
        let html = "<table><tr><th>Vendedor</th><th>Total</th></tr>";

        for (let vendedor in totais) {
            html += `<tr>
                        <td>${vendedor}</td>
                        <td>R$ ${totais[vendedor].toFixed(2)}</td>
                     </tr>`;
        }

        html += "</table>";

        document.getElementById("resultado").innerHTML = html;
    };

    reader.readAsArrayBuffer(file);
});
</script>

</body>
</html>
